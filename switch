#! /usr/bin/env bash

# Shows the output of every command
set +x

rebuild_home() {
  nix build --impure .#homeConfigurations.gvolpe-hdmi.activationPackage
  result/activate
}

rebuild_system() {
  #nix build .#nixosConfigurations.tongfang-amd.config.system.build.toplevel
  #sudo result/bin/switch-to-configuration switch
  # this command is equivalent to the two commands above
  sudo nixos-rebuild switch --flake .#tongfang-amd
}

case $1 in
  "home")
    hms;; # hms selects edp or hdmi automagically
  "system")
    rebuild_system;;
  *)
    echo "expected 'home' or 'system'";;
esac
